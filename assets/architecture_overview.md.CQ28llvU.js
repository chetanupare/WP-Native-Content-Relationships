import{_ as t,c as a,o as r,ag as i}from"./chunks/framework.D7F4Kr4v.js";const u=JSON.parse('{"title":"Architecture Overview","description":"High-level architecture of Native Content Relationships — core, registry, database, integrity, API.","frontmatter":{"title":"Architecture Overview","description":"High-level architecture of Native Content Relationships — core, registry, database, integrity, API."},"headers":[],"relativePath":"architecture/overview.md","filePath":"architecture/overview.md","lastUpdated":1771058779000}'),o={name:"architecture/overview.md"};function n(c,e,s,l,d,h){return r(),a("div",null,[...e[0]||(e[0]=[i('<h1 id="architecture-overview" tabindex="-1">Architecture Overview <a class="header-anchor" href="#architecture-overview" aria-label="Permalink to &quot;Architecture Overview&quot;">​</a></h1><p>High-level architecture of the Native Content Relationships plugin.</p><h2 id="system-components" tabindex="-1">System components <a class="header-anchor" href="#system-components" aria-label="Permalink to &quot;System components&quot;">​</a></h2><ul><li><strong>Core:</strong> Public API (<code>ncr_add_relation</code>, <code>ncr_get_related</code>, etc.) → Relationship Type Registry → Database (<code>wp_content_relations</code>) + Object Cache</li><li><strong>Integrity:</strong> WP-CLI / scheduled tasks → Repair logic → Schema and constraint checks → reads/writes DB</li><li><strong>Interfaces:</strong> Admin meta box, REST API, Elementor Dynamic Tags, Gutenberg block — all use the Public API</li></ul><h2 id="key-components" tabindex="-1">Key components <a class="header-anchor" href="#key-components" aria-label="Permalink to &quot;Key components&quot;">​</a></h2><h3 id="_1-registry-layer" tabindex="-1">1. Registry layer <a class="header-anchor" href="#_1-registry-layer" aria-label="Permalink to &quot;1. Registry layer&quot;">​</a></h3><p>Defines allowed relationship types and their constraints: <code>max_connections</code>, <code>direction</code>, <code>object_types</code>. Implemented in the relation-types layer.</p><h3 id="_2-database-layer" tabindex="-1">2. Database layer <a class="header-anchor" href="#_2-database-layer" aria-label="Permalink to &quot;2. Database layer&quot;">​</a></h3><ul><li><strong>Table:</strong> <code>wp_content_relations</code></li><li><strong>Indexes:</strong> Composite on <code>(from_id, type)</code> and <code>(to_id, type)</code>; covering index on <code>(type, from_id, to_id)</code>.</li><li><strong>Schema guard:</strong> <code>NCR_SCHEMA_VERSION</code> ensures DB updates run only when needed.</li></ul><p>See <a href="/WP-Native-Content-Relationships/architecture/schema.html">Schema</a>.</p><h3 id="_3-integrity-engine" tabindex="-1">3. Integrity engine <a class="header-anchor" href="#_3-integrity-engine" aria-label="Permalink to &quot;3. Integrity engine&quot;">​</a></h3><ul><li>Chunked processing for large datasets (1M+ rows)</li><li>Orphan detection (relations to deleted posts/users)</li><li>Constraint enforcement (e.g. max_connections)</li></ul><h3 id="_4-public-api" tabindex="-1">4. Public API <a class="header-anchor" href="#_4-public-api" aria-label="Permalink to &quot;4. Public API&quot;">​</a></h3><p>Facade for create/read/remove; validates against the registry and uses object cache where appropriate.</p>',14)])])}const g=t(o,[["render",n]]);export{u as __pageData,g as default};
