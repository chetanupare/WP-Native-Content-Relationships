import{_ as t,c as o,o as s,ag as i}from"./chunks/framework.D7F4Kr4v.js";const u=JSON.parse('{"title":"Troubleshooting","description":"Empty results, permissions, WP_Query, REST, shortcodes — common issues and fixes.","frontmatter":{"title":"Troubleshooting","description":"Empty results, permissions, WP_Query, REST, shortcodes — common issues and fixes."},"headers":[],"relativePath":"guide/troubleshooting.md","filePath":"guide/troubleshooting.md","lastUpdated":1771061476000}'),a={name:"guide/troubleshooting.md"};function n(r,e,l,h,d,p){return s(),o("div",null,[...e[0]||(e[0]=[i(`<h1 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h1><h2 id="no-related-posts-empty-shortcode" tabindex="-1">No related posts / empty shortcode <a class="header-anchor" href="#no-related-posts-empty-shortcode" aria-label="Permalink to &quot;No related posts / empty shortcode&quot;">​</a></h2><p><strong>Check:</strong></p><ol><li><strong>Relations exist</strong> — In the post editor, open the relationship panel and confirm links are saved. Or query the table: <code>SELECT * FROM wp_content_relations WHERE from_id = &lt;post_id&gt; AND type = &#39;related_to&#39;;</code> (use your prefix).</li><li><strong>Correct type</strong> — Shortcode <code>type</code> and PHP <code>relation_type</code> must match a registered type (e.g. <code>related_to</code>). Typos or wrong type = no results.</li><li><strong>Post ID</strong> — Shortcode uses current post in the loop. On archive or outside the loop, pass <code>post_id=&quot;123&quot;</code> or use PHP and <code>ncr_get_related( 123, &#39;post&#39;, &#39;related_to&#39;, ... )</code>.</li><li><strong>Status</strong> — Shortcodes only list <strong>published</strong> posts. Draft/private targets are excluded from output (they may still be stored as relations).</li></ol><h2 id="wp-query-with-content-relation-returns-nothing" tabindex="-1">WP_Query with content_relation returns nothing <a class="header-anchor" href="#wp-query-with-content-relation-returns-nothing" aria-label="Permalink to &quot;WP_Query with content_relation returns nothing&quot;">​</a></h2><ul><li><strong>Keys:</strong> Use <code>content_relation</code> (not <code>ncr_relation</code>). Required keys: <code>post_id</code>, <code>type</code>. Optional: <code>direction</code> (<code>&#39;from&#39;</code> or <code>&#39;to&#39;</code>).</li><li><strong>Direction:</strong> For “posts that are related TO this one” use <code>&#39;direction&#39; =&gt; &#39;to&#39;</code>. For “posts this one points TO” use <code>&#39;direction&#39; =&gt; &#39;from&#39;</code> (often default).</li><li><strong>Post type:</strong> Ensure <code>post_type</code> matches the related posts (e.g. <code>post</code>, <code>page</code>, or your CPT).</li></ul><p>Example:</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$q </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> WP_Query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">( [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&#39;post_type&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        =&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;post&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&#39;content_relation&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">		&#39;post_id&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_the_ID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">		&#39;type&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      =&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;related_to&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">		&#39;direction&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;to&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] );</span></span></code></pre></div><p>See <a href="/WP-Native-Content-Relationships/api/wp-query.html">WP_Query</a>.</p><h2 id="permission-errors-when-creating-relations" tabindex="-1">Permission errors when creating relations <a class="header-anchor" href="#permission-errors-when-creating-relations" aria-label="Permalink to &quot;Permission errors when creating relations&quot;">​</a></h2><ul><li><strong>Capability:</strong> Creating relations requires <code>naticore_create_relation</code> (or equivalent). Editors and above usually have it. If you use custom roles, grant this capability or use a filter to allow creation.</li><li><strong>Filter:</strong> <code>naticore_relation_is_allowed</code> can block a relation. Return <code>false</code> to disallow. Check custom code that uses this filter.</li><li><strong>Self-relation:</strong> Post cannot relate to itself. Same for user–user if you add such a type. The API returns an error in that case.</li></ul><h2 id="rest-api-404-or-route-not-found" tabindex="-1">REST API: 404 or “route not found” <a class="header-anchor" href="#rest-api-404-or-route-not-found" aria-label="Permalink to &quot;REST API: 404 or “route not found”&quot;">​</a></h2><ul><li><strong>Base:</strong> NCR routes live under <code>/wp-json/naticore/v1/</code>. Ensure permalinks are not plain (Settings → Permalinks: use any non-plain structure) and that REST is not disabled by another plugin.</li><li><strong>Auth:</strong> Creating or deleting relations via REST usually requires authentication (cookie or application password). Unauthenticated GET may work for public content depending on your setup.</li></ul><h2 id="rest-embed-naticore-relations-1-empty" tabindex="-1">REST embed (?naticore_relations=1) empty <a class="header-anchor" href="#rest-embed-naticore-relations-1-empty" aria-label="Permalink to &quot;REST embed (?naticore_relations=1) empty&quot;">​</a></h2><ul><li><strong>Query param:</strong> Use <code>?naticore_relations=1</code> on the <strong>single resource</strong> URL, e.g. <code>GET /wp-json/wp/v2/posts/123?naticore_relations=1</code>. Not on listing endpoints.</li><li><strong>Response key:</strong> Look for <code>naticore_relations</code> in the JSON response. If the post has no relations, the array is empty.</li></ul><h2 id="shortcode-outputs-nothing" tabindex="-1">Shortcode outputs nothing <a class="header-anchor" href="#shortcode-outputs-nothing" aria-label="Permalink to &quot;Shortcode outputs nothing&quot;">​</a></h2><ul><li><strong>post_id:</strong> On homepage or archive there may be no “current post”. Set <code>post_id=&quot;123&quot;</code> explicitly.</li><li><strong>Type and limit:</strong> Ensure <code>type</code> is valid and <code>limit</code> ≥ 1.</li><li><strong>CSS:</strong> Content may be there but hidden by your theme. Inspect the HTML; wrapper classes are <code>.naticore-related-posts</code>, <code>.naticore-related-list</code>, etc.</li></ul><h2 id="duplicate-or-wrong-relations-after-migration" tabindex="-1">Duplicate or wrong relations after migration <a class="header-anchor" href="#duplicate-or-wrong-relations-after-migration" aria-label="Permalink to &quot;Duplicate or wrong relations after migration&quot;">​</a></h2><ul><li>Run the migration <strong>once</strong>. Running ACF (or other) migration again can duplicate links.</li><li>Use the <strong>Integrity</strong> or <strong>Orphaned</strong> tools (if available in your version) under <strong>Settings → Content Relationships</strong> to find and clean orphaned or duplicate relations.</li></ul><h2 id="performance-with-many-relations" tabindex="-1">Performance with many relations <a class="header-anchor" href="#performance-with-many-relations" aria-label="Permalink to &quot;Performance with many relations&quot;">​</a></h2><ul><li>NCR uses an indexed table. For very large datasets (tens of thousands of relations per post), use <code>limit</code> in queries and consider caching <code>ncr_get_related()</code> results (e.g. transients) for heavy pages. See <a href="/WP-Native-Content-Relationships/performance/benchmarks.html">Performance</a> and <a href="/WP-Native-Content-Relationships/performance/scaling-guide.html">Scaling</a>.</li></ul><h2 id="getting-help" tabindex="-1">Getting help <a class="header-anchor" href="#getting-help" aria-label="Permalink to &quot;Getting help&quot;">​</a></h2><ul><li><a href="https://github.com/chetanupare/WP-Native-Content-Relationships/issues" target="_blank" rel="noreferrer">GitHub Issues</a> — bugs and feature requests.</li><li><a href="https://wordpress.org/support/plugin/native-content-relationships/" target="_blank" rel="noreferrer">WordPress.org support forum</a> — general support.</li></ul><p>Include: WordPress and PHP version, NCR version, and what you tried (shortcode/PHP/REST + expected vs actual result).</p>`,24)])])}const g=t(a,[["render",n]]);export{u as __pageData,g as default};
